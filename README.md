# Детектирование заставок в сериалах

## Описание проекта

Проект для автоматического определения временных интервалов заставок в сериалах с использованием мультимодального подхода (аудио + видео).

## Стек технологий

- Python 3.8+
- torch
- FFmpeg
- numpy

## Техническая реализация

1. **Обработка видео**:
 - Видео нарезается на пересекающиеся клипы (5 сек с перекрытием 2.5 сек)
 - Используется `VideoReader` для чтения видео и получения характеристик
 - Из каждого клипа извлекается 8 ключевых кадров

2. **Извлечение признаков**:
   - **Видео**: CLIP-эмбеддинги (512-мерные векторы) для каждого кадра
   - **Аудио**: 13 MFCC коэффициентов с шагом 512 (частота дискретизации 22050 Гц)

3. **Модель классификации**:
   - Трансформер для объединения признаков
   - Полносвязная сеть для бинарной классификации
   - Порог срабатывания: 0.5 (настраивается в config.yml)

4. **Постобработка**:
- Объединение пересекающихся интервалов
- Формирование итогового JSON с таймкодами

## Установка

1. Установите зависимости:
```
pip install -r requirements.txt
```

2. Настройте параметры проекта в config.yml

3. Загрузите в папку данных видеофайлы, и json по образцу с таймкодами.

3. Запустите run_train.py для обучения модели

4. Запустите run_test.py для тестирования модели
